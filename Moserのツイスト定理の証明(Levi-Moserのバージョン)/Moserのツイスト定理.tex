\documentclass[a4paper]{ujarticle}
\usepackage[margin=15mm]{geometry}
\usepackage{graphicx}
\usepackage[dvipdfmx]{color}
\usepackage{amsmath,amssymb,amsthm}
\usepackage{mathtools}
\mathtoolsset{showonlyrefs=true}
\usepackage{bm} %太字
\usepackage{tcolorbox} %定理環境のやつ
\usepackage{physics}
\tcbuselibrary{breakable, skins, theorems}
\usepackage{enumerate} %箇条書き
\usepackage{ulem} %下線
\usepackage{mathrsfs} %花文字
\usepackage{url}

%コマンド
\newcommand{\red}[1]{\textcolor{red}{#1}} %赤文字
\newcommand{\vecn}[1]{({#1}_1, \cdots, {#1}_{n})}
\newcommand{\inner}[2]{(#1, #2)}
\newcommand{\R}{\mathbb{R}}
\newcommand{\C}{\mathbb{C}}
\newcommand{\Q}{\mathbb{Q}}
\newcommand{\Lpn}[1]{\|#1\|_{L^{p}}}
\newcommand{\esssup}[1]{\mathop{\mathrm{ess.sup}}_{#1}}
\newcommand{\cl}[1]{\bar{#1}}
\newcommand{\pd}[2]{\partial_{#1}^{#2}}
\newcommand{\alev}{\ \mathrm{a.e.}}
\newcommand{\sgn}{\mathrm{sgn}}
\newcommand{\weak}{\ \mathrm{(weakly)}}
\newcommand{\Div}{\mathrm{div}}
\newcommand{\Grad}{\mathrm{grad} }
\newcommand{\Rot}{\mathrm{rot} }


\numberwithin{equation}{section}
\mathtoolsset{showonlyrefs=true}
\newcommand{\rme}{\mathrm{e}}

\theoremstyle{definition}
\newtheorem{definition}{Definition}
\newtheorem{theorem}{Theorem}
\newtheorem{proposition}{Proposition}
\newtheorem{example}{Example}
\newtheorem{lemma}{Lemma}
\newtheorem{cor}{Corlollary}
\newtheorem{remark}{Remark}
\newtheorem{conj}{Conjecture}
\newtheorem{axiom}{Axiom}
%%証明環境
\makeatletter
\renewenvironment{proof}[1][Proof]{\par
  \pushQED{\qed}%
  \normalfont \topsep6\p@\@plus6\p@\relax
  \trivlist
  \item\relax
  {\bfseries
  #1\@addpunct{.}}\hspace\labelsep\ignorespaces
}{%
  \popQED\endtrivlist\@endpefalse
}

\title{Moserのツイストの定理}
\begin{document}
\date{2025年9月11日}
\author{まるげり}
\maketitle
    Levi-Moser\cite{LM01}のノート. 
    面積保存ツイスト写像の母関数に解析性を課すが, ツイスト定理の証明としては一番読みやすいと思う. 

    \section{背景: 面積保存ツイスト写像, 母関数}
        アニュラス$\mathbb{A} = \mathbb{S}^1 \times \mathbb{R}$上の面積保存ツイスト写像$\varphi(x_1, y_1) = (x_2, y_2)$とは, 
        面積保存性$\varphi^{*}(dy_2 \wedge dx_2) = d y_1 \wedge d x_1$と
        ツイスト性$\displaystyle \frac{\partial x_2}{\partial y_1} > 0$を持つものである.

        記号の濫用で, $\mathbb{S}^1 \times \mathbb{R}$の普遍被覆$\mathbb{R}^2$上の元もまた$(x, y)$のように書き, 
        また$\varphi$の$\mathbb{R}^2$への持ち上げも$\varphi$と書くことにすると, 
        面積保存ツイスト写像$\varphi$が特に$\mathbb{A}$上の完全シンプレクティック写像($\varphi^{*}(y dx) - y dx$が$\mathbb{A}$上の完全形式になる)とき, 
        $\varphi$の母関数と呼ばれる, 次の性質を満たす関数$h: \mathbb{R}^2 \rightarrow \mathbb{R}$が存在する:\\
        $h_1, h_2$をそれぞれ$h$の第$1$成分, 第$2$成分での偏微分としたときに, $h(x_1 + 1, x_2 + 1) = h(x_1, x_2), h_{12} < 0$であり, 
        さらに
        \[
            \left\{
            \begin{aligned}
                h_1(x_1, x_2) &= - y_1 \\
                h_2(x_1, x_2) &= y_2
            \end{aligned}
            \right.
            \iff \varphi(x_1, y_1) = (x_2, y_2)
        \]
        となる.\\
        (たぶん, $\mathbb{R}^2$で考える以上はポアンカレの補題から閉形式$\varphi^{*}(y dx) - y dx$が完全形式になることが保証されるけど, 
        アニュラス$\mathbb{A}$上でもなお$h$が意味を持つためには別で$\mathbb{A}$上で完全形式になることを保証しないといけない...のだと思う.)
        
        特に$\varphi$が母関数$h$を持つなら, $(x_1, y_1)$が与えられた下で, $\{(x_n, y_n)\}_{n}$が軌道$\{\varphi^{n}(x_1, y_1)\}_{n}$になることと
        \[
                h_2(x_{i-1}, x_{i}) + h_1(x_{i}, x_{i+1}) = 0, \ y_i = - h_2(x_{i}, x_{i+1}) \quad (\forall i \in \mathbb{Z})
        \]
        が同値であることがわかる.

    \section{不変曲線と差分方程式への簡約化}
        面積保存ツイスト写像$\varphi$の不変曲線$\gamma \subset \mathbb{A}$とは, 
        $\varphi$の不変集合であって$\mathbb{R}^2$上への持ち上げを$w(\theta) = (u(\theta), v(\theta))$としたときに
        $u(\theta) - \theta$および$v(\theta)$が周期$1$の周期関数となるものである.
        これは, $u(\theta + 1) - (\theta + 1) = u(\theta) - \theta$より$u(\theta + 1) - u(\theta) = 1$より, 
        アニュラス$\mathbb{A}$を$x$方向に一周して戻ってくる曲線であることを意味している.
        
        さて, ある回転数$\omega$についての不変曲線$\gamma$, つまり
        \[
                \varphi(w(\theta)) = w(\theta + \omega)
        \]
        を見つけたい. これはラグランジュ方程式と呼ばれることもある次の$2$階差分方程式
        \begin{equation} \label{eq:3}
            E[u(\theta)] = h_1(u(\theta), u(\theta + \omega)) + h_2(u(\theta), u(\theta - \omega)) \equiv 0
        \end{equation}
        が解ければ, $v(\theta) = - h_1(u(\theta), u(\theta + \omega))$とおくことで不変曲線を見つけることができる.
        以下, $u^{+}(\theta) = u(\theta + \omega), u^{-}(\theta) = u(\theta - \omega)$とする.

        \begin{remark}
            あとで使うので, $u_{\theta} E[u]$の平均値$\displaystyle \int^{1}_{0} (u_{\theta} E[u])(\theta) d \theta = 0$を計算しておく.
            \[
                \frac{\partial h}{\partial \theta}(u, u^{+}) = u_{\theta} (h_1(u, u^{+}) + h_2(u, u^{+}))
            \]
            より, $\nabla f := f(\theta + \omega) - f(\theta)$と表記すれば,
            \begin{align}
                \frac{\partial h}{\partial \theta}(u, u^{+}) - u_{\theta} h_2(u^{-}, u)
                &= u_{\theta} (h_1(u, u^{+}) + h_2(u, u^{+}) - h_2(u, u^{+}) + h_2(u^{-}, u)) \\
                &= u_{\theta} (h_1(u, u^{+}) + h_2(u^{-}, u)) \\
                &= u_{\theta} E[u]
            \end{align}
            したがって, 
            \[
                u_{\theta} E[u] = \frac{\partial h}{\partial \theta}(u, u^{+}) - u_{\theta} h_2(u^{-}, u)
            \]
            と表すことができる.
            ここで, $h(x_1+1, x_2 + 1) = h(x_1, x_2)$であることと, 
            $f(\theta)$が周期$1$の周期関数であれば$\displaystyle \int^{1}_{0} (\nabla f)(\theta) d \theta = \int^{1}_{0} (f(\theta + \omega) - f(\theta)) d \theta = 0$であることから,
            結局
            \[
                \int^{1}_{0} (u_{\theta} E[u])(\theta) d \theta = 0
            \]
            である.

        \end{remark}

        \begin{example}[standard map]
            $S(x)$を周期関数として, $\varphi(x_1, y_1) = (x_2, y_2)$を
            \begin{align}
                x_2 &= x_1 + y_1 + S'(x_1), \\
                y_2 &= y_1 + S'(x_1)
            \end{align}
            で定める. 母関数$h$は
            \[
                h(x_1, x_2) = \frac{1}{2}(x_1 - x_2)^2 + S(x_1)
            \]
            である. これに対するラグランジュ方程式\eqref{eq:3}は
            \[
                u(\theta + \omega) - 2 u(\theta) + u(\theta - \omega) = S'(u(\theta))
            \]
            と書ける.
        \end{example}

    \section{ツイスト定理}

        ツイスト定理は, $\omega$がディオファントス数であるときに,
        $E[u_0] \approx 0$なる$u_0(\theta)$から始めて$E[u] \equiv 0$となる$u(\theta)$の存在を示す定理である.
        
        \[
            W_r := \left\{f: \mathbb{C} \rightarrow \mathbb{C} \middle| f : \text{実解析的}, \ f(\theta + 1) = f(\theta), \ |f|_r := \sup_{|\mathrm{Im} \theta| \leq r} |f(\theta)| < \infty \right\}
        \]
        する.

        複素領域$\mathcal{D} \subset \mathbb{C}^2$を考え, その$R$-近傍を$\mathcal{D}_{R} := \{z \in \mathcal{D} | \sup_{y \in \mathcal{D}}|y - z| \}$と書くことにする.
        \begin{itemize}
            \item $h$に関する仮定: \\
            $h(x_1, x_2)$が$(x_1, x_2) \in \mathcal{D}$で解析的, $(x_1, x_2) \in \mathcal{D} \cap \mathbb{R}^2$で実, 
            $h(x_1 + 1, x_2 + 1) = h(x_1, x_2)$を満たす. \\
            また, ある定数$\kappa > 0, M > 0$により, 
            \begin{align}
                \min_{\mathcal{D}} |h_{12}| &> \kappa, \label{eq:5} \\
                |h|_{C^3(\mathcal{D})} &< M. \label{eq:6}
            \end{align}
            \item $u_0$に関する仮定: \\
            ある$r \in (0, 1)$に対して, $u_0(\theta) - \theta \in W_r$である. \\
            さらに, ある(十分大きな)$N_0 > 0$に対し, 
            \begin{align}
                &(u_0, u^{+}_0) \in \mathcal{D}_{R} \quad (|\mathrm{Im} \theta| < r) \label{eq:7}, \\
                &|(u_0)_{\theta}|_r < N_0, \quad |(u_0)^{-1}_{\theta}|_r < N_0. \label{eq:8}
            \end{align}
        \end{itemize}

        \begin{theorem}[ツイスト定理]
            $\omega$がディオファントス数, つまり, ある$K > 0, \sigma > 0$が存在して, 
            任意の$p, q \in \mathbb{Z} \backslash \{0\}$について
            \begin{equation}
                |\omega - \frac{p}{q}| \geq \frac{K}{q^{2 + \sigma}}
            \end{equation}
            であるとする.

            $h, u_0$が上の仮定を満たすとする. このとき, ある定数$\delta = \delta(r, h, M, N_0, K, \sigma, \kappa)$が存在し,
            もし$|E(u_0)|_r < \delta$であればラグランジュ方程式$E[u] \equiv 0$の解$u$で, $u_0$に近く, $u(\theta) - \theta \in W_{r/2}$を満たし, 
            $u(\theta) - \theta$の$\theta \in \mathbb{S}^1$での平均値が$0$になるものがただ一つ存在する.
        \end{theorem}

        \begin{example}
            摂動を受けたツイスト写像
            \begin{align}
                x_2 &= x_1 + y_1 + \epsilon f(x_1, y_1, \epsilon) \\
                y_2 &= y_1 + \epsilon g(x_1, y_1, \epsilon)
            \end{align}
            が領域$\mathcal{D} := \{(x_1, x_2) \in \mathbb{C}^2 | a < \mathrm{Re}(x_1 - x_2) < b, \ |\mathrm{Im} x_1| < 1, \ |\mathrm{Im} x_2| < 1\}$上で定義された
            母関数$h(x_1, x_2) = \frac{1}{2}(x_1 - x_2)^2 + \epsilon H(x_1, x_2, \epsilon)$を持つとする. ($|H|_{C^3(\mathcal{D})}$が有界まで要りそう.)

            ディオファントス数$\omega \in (a, b)$と$u_0(\theta) = \theta$を選ぶ.
            いま, $\epsilon$を十分小さく取れば, 
            $|h_{12}| = |- 1 + \epsilon H_{12}| > 1 - O(\epsilon)$より\eqref{eq:5}はok.
            $|h_{i}| \leq |x_1 - x_2| + \epsilon |H_{1}| < b + 2 + O(\epsilon), |h_{ii}| = |1 + \epsilon H_{ii}|  < 1 + O(\epsilon), |h_{ijk}| < \epsilon|H_{ijk}| < O(\epsilon)$
            より\eqref{eq:6}もok. 
            $\displaystyle R =  \min\left\{\frac{1}{2\sqrt{2}}(b - \omega), \frac{1}{2\sqrt{2}}(\omega - a), r\right\}$として, 
            $(u_0, u^{+}_0) = (\theta, \theta + \omega) \in D_{R} \ (|\mathrm{Im} \theta| < r)$より\eqref{eq:7}はok.
            $u_0 = (u_0)^{-1} = \theta$なので$N_0 = \max\{-a, b\} + r$とすれば\eqref{eq:8}もok.

            以上から, ツイスト定理が使えて, 不変曲線の存在が証明できる.
        \end{example}

        \section{homological equation}
        ツイスト定理の証明のカギは, 初期解$u_0$から始めて"修正ニュートン法"によって$E[u]$の零点を探すことである.
        $\tilde{u} = u + v$として, $E[\tilde{u}]$は
        \[
            E[u + v] = E[u] + E'[u] v + Q(v)
        \]
        と書ける. ここで, $Q$は剰余項であり, $E'[u]v$はガトー微分である.
        具体的に計算すると, $h_{ij}^{-} = h_{ij}(u^{-}, u)$として, 
        \begin{equation} \label{eq:11}
            E'[u] v = (h_{11} + h_{22}^{-})v + h_{12} v^{+} + h_{12}^{-} v^{-}
        \end{equation}
        と書き下すことができる.

        ふつうのニュートン法では, $v$に関する方程式
        \begin{equation} \label{eq:12}
            E'[u] v = - E[u]
        \end{equation}
        の解として$v$を定める.

        今回は, \eqref{eq:12}の代わりに, 両辺に$u_{\theta}$を掛けて左辺から$v \frac{d}{d \theta} E[u] = v E'[u] u_{\theta}$を引いた方程式
        \begin{equation} \label{eq:13}
            u_{\theta} E'[u] v - v E'[u] u_{\theta} = - u_{\theta} E[u]
        \end{equation}
        の解として$v$を与える. もちろんこれは\eqref{eq:12}とは等価ではない式だが, この場合の更新則$u \mapsto u + v$でも$E[u]$の零点へ収束することを後に示す.
        \eqref{eq:13}のままだと扱いにくいので, 少し変形する. 左辺が
        \[
            u_{\theta} E'[u] v - v E'[u] u_{\theta} = h_{12}(u_{\theta} v^{+} - u_{\theta}^{+} v) + h_{12}^{-}(u_{\theta} v^{-} - u_{\theta}^{-} v)
        \]
        であることに注意して, 新変数$w := \frac{v}{u_{\theta}}$を導入すれば, 
        \[
            h_{12}(u_{\theta} v^{+} - u_{\theta}^{+} v) + h_{12}^{-}(u_{\theta} v^{-} - u_{\theta}^{-} v) = h_{12} u_{\theta} u_{\theta}^{+}(w^{+} -  w) - h_{12}^{-} u^{-}_{\theta} u_{\theta} (w - w^{-}) = \nabla^{*}(h_{12} u_{\theta} u_{\theta}^{+} \nabla w )
        \]
        となる. ただし, 
        \[
            \nabla f(\theta) := f(\theta + \omega) - f(\theta), \quad \nabla^{*} f(\theta) := f(\theta) - f(\theta - \omega)
        \]
        と表記した.

        まとめると, $w$に関する関数方程式
        \begin{equation} \label{eq:14}
            \nabla^{*}(h_{12} u_{\theta} u_{\theta}^{+} \nabla w ) = - u_{\theta} E[u]
        \end{equation}
        の解として$w$を選び, 更新則
        \begin{equation} \label{eq:15}
            \tilde{u} = u + v, \quad v = u_{\theta} w
        \end{equation}
        を考える. 初期解$u_0$から始めて最終的に$u$が$E[u]$の零点に収束することを示す.
        \section{homological equationの求解}
        $u$を既知, $w$を未知の関数とする.

        \red{TO DO: ツイスト定理の証明をまとめる}
    \begin{thebibliography}{10}
    \nocite{*}
	\bibitem{LM01}  M. Levi and J. Moser, A Lagrangian proof of the invariant curve theorem for twist mappings, 
    Smooth ergodic theory and its applications (Seattle, WA, 1999), Proc. Sympos. Pure Math. \textbf{69}, 733-746, Amer. Math. Soc., Providence, RI, 2001 
\end{thebibliography}
\end{document}